<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, target-densityDpi=device-dpi" />  
    <title>Admin Dashboard</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <link rel="stylesheet" href="../css/adminpanel.css">
</head>
<body>
    <div class="content" id="content">
        <div class="col1" id="col1">
          
            <div class="logo">
				<div class="ishimwe">ISHIMWE</div>
				<div class="bernard">BERNARD</div>
            </div>
            <div class="profilecontainer">
            </div>
            <div class="navigation" >
                <div class="navItem" onclick="changeTab('col2')">
                    <img src="../assets/images/users.png" alt="" >
                    <h4 class="navTitle"  id="dashboard">Dashboard</h4>
                </div>
                <div class="navItem" onclick="changeTab('usersTab')">
                    <img src="../assets/images/users.png" alt="">
                    <h4 class="navTitle"  id="users">Users</h4>
                </div>
                <div class="navItem" onclick="changeTab('Articles')">
                    <img src="../assets/images/users.png" alt="">
                    <h4 class="navTitle"  id="articles">Articles</h4>
                </div>
                <div class="navItem" id="backButton"  onclick="REVEALDOM()">
                    <h4 class="navTitle">Back</h4>
                    <img src="../assets/images/back.png" alt="">

                </div>
                
                
            </div>
          
         
        </div>
        <div id="col2" class="col2">
            <div class="searchdiv">
                <input type="text" class="searchText" placeholder="Search through the Content">
            </div>
            <h1>Dashboard <span>Overview</span></h1>
            <div class="parent">
                <div class="childcontainer">
                    <div class="row">
                        <div class="card">
                            <img src="../assets/images/tiles.png" alt="">
                            <h1 class="numeral">12K</h1>
                            <p class="whats">Users</p>
                            <p class="increment">+ 250</p>
                        </div>
                        <div class="card">
                            <img src="../assets/images/subscribers.png" alt="">
                            <h1 class="numeral">12K</h1>
                            <p class="whats">Subscribers</p>
                            <p class="increment">+ 250</p>
                        </div>
                        
                    </div>
                    <div class="row">
                        <div class="card">
                            <img src="../assets/images/articles.png" alt="">
                            <h1 class="numeral">12K</h1>
                            <p class="whats">Articles</p>
                            <p class="increment">+ 250</p>
                        </div>
                        <div class="card">
                            <img src="../assets/images/online.png" alt="">
                            <h1 class="numeral">12K</h1>
                            <p class="whats">Online</p>
                            <p class="increment">+ 250</p>
                        </div>
                        
                    </div>
                </div>
                <div class="card" id="subscribersChart">
                    
                </div>
            </div>
            <div class="parenttwo">
                <div class="card" id="orderhistory">
        
                    <p class="header">Order History</p>
                    <div class="line"> </div>
                    <div class="tablehead">
                        <p class="cont">Customer</p>
                        <p class="orderno">Order No</p>
                        <p class="date">Date</p>
                    </div>
                    <div class="tableheadx">
                        <div class="r1">
                            <img src="../assets/images/owner.PNG">
                            <div class="textContent">
                                <p class="username">ISHIMWE Bernard</p>
                                <div class="status">
                                    <div class="circl"> </div>
                                    <p class="st">Acount Closed</p>
                                </div>
                            </div>
                        </div>
                        <p class="on">162356853482</p>
                        <p class="on">21/5/2015</p>
                    </div>
                    <div class="tableheadx">
                        <div class="r1">
                            <img src="../assets/images/user1.PNG">
                            <div class="textContent">
                                <p class="username">Kylian Mbappe</p>
                                <div class="status">
                                    <div class="circl" id="active"> </div>
                                    <p class="st">Acount Active</p>
                                </div>
                            </div>
                        </div>
                        <p class="on">162356853482</p>
                        <p class="on">21/5/2015</p>
                    </div>
                    <div class="tableheadx">
                        <div class="r1">
                            <img src="../assets/images/user2.PNG">
                            <div class="textContent">
                                <p class="username">ISHIMWE Bernard</p>
                                <div class="status">
                                    <div class="circl"> </div>
                                    <p class="st">Acount Closed</p>
                                </div>
                            </div>
                        </div>
                        <p class="on">162356853482</p>
                        <p class="on">21/5/2015</p>
                    </div>
                    <div class="tableheadx">
                        <div class="r1">
                            <img src="../assets/images/user3.png">
                            <div class="textContent">
                                <p class="username">ISHIMWE Bernard</p>
                                <div class="status">
                                    <div class="circl"> </div>
                                    <p class="st">Acount Closed</p>
                                </div>
                            </div>
                        </div>
                        <p class="on">162356853482</p>
                        <p class="on">21/5/2015</p>
                    </div>
                    <div class="tableheadx">
                        <div class="r1">
                            <img src="../assets/images/user4.PNG">
                            <div class="textContent">
                                <p class="username">Dave Marvin</p>
                                <div class="status">
                                    <div class="circl" id="active"> </div>
                                    <p class="st">Acount Active</p>
                                </div>
                            </div>
                        </div>
                        <p class="on">162356853482</p>
                        <p class="on">21/5/2015</p>
                    </div>
                </div>
                <div class="childcontainertwo">
                  <div class="serverusagecard">
                    <h2>Server Load</h2>
                    <h1>69.52%</h1>
                    <p class="usage">Usage</p>
                    <div class="progress">
                        <div class="bar"> </div>
                    </div>
                  </div>
                  <div class="serverusagecard">
                    <h2>Performance Monitor</h2>
                    <h1>3500</h1>
                    <p class="usage">More Traffic</p>
                    <div id="trafficgraph">

                    </div>
                  </div>
                 
                </div>
               
            </div>
            <div class="queries">
                <h1>Queries</h1>
               <div class="qrows" id="qrows">
               </div>
            </div>
        </div>
        <div class="col2" id="usersTab">
            <div class="hdcnt">
                <div id="mobileNavigationButton" class="mobileNavigationButton" style="float:left; margin-top: 1.15rem; cursor: pointer;" onclick="REVEALDOM()">
                    <div class="line" style=" margin-top: .25rem; width: 2rem; height: .25rem; background: #000"></div>
                    <div class="line" style=" margin-top: .25rem; width: 2rem; height: .25rem; background: #000"></div>
                    <div class="line" style=" margin-top: .25rem; width: 2rem; height: .25rem; background: #000"></div>
                </div>
               <h1 id="userTitleInTitle" class="col2Title" style="margin-left: 5rem;">Users</h1>
              
               </div>
              <div class="newSexion">
                  <div class="singleUserInfo" id="singleUserInfo">
                      <div class="basInfo">
                        <img src="../assets/images/user4.png" class="profile" id="profile">
                       <div class="tt">
                        
                            <h3 class="title" id="name">John Jones</h3>
                            <div class="cred">
                                <img src="../assets/images/location.png" alt="">
                                <div class="p" id="location">Massachusets</div>
                            </div>
                            <div class="cred">
                              <img src="../assets/images/gmail.png" alt="">
                              <div class="p" id="email">emailemail.com</div>
                          </div>
                          <div class="cred">
                              <img src="../assets/images/time.png" alt="">
                              <div class="p" id="dateJoined">Joined: 1/1/2000</div>
                          </div>
                       
                       </div>
                      </div>
                      <div class="textSection">
                        <div class="header">
                            <p>Action</p>
                            <p>Date</p>
                        </div>
                        <div class="item">
                            <p>Comment</p>
                            <p>10/28/12</p>
                        </div>
                        <div class="item">
                            <p>Read Article</p>
                            <p>10/28/12</p>
                        </div>
                        <div class="item">
                            <p>Call me</p>
                            <p>10/28/12</p>
                        </div>
                        <div class="item">
                            <p>SDprinted</p>
                            <p>10/28/12</p>
                        </div>
                        <div class="item">
                            <p>Ate</p>
                            <p>10/28/12</p>
                        </div>
                        <div class="item">
                            <p>Called Me</p>
                            <p>10/28/12</p>
                        </div>
                      </div>
                  </div>
                <div class="usersDisplayer">
                    <div class="user" onclick="displayInformation('../assets/images/user1.png','Ronald Richards','Rwanda','ishimer','2001')">
                        <img class="userProfile" role="img" aria-label="User" src="../assets/images/user1.png">
                        <div class="credentials">
                            <div class="nameAndStatus">
                                <p class="name">Ronald Richards</p>
                                <div class="avail"></div>
                            </div>
                            <p class="email">emailemail@gmail.com</p>
                        </div>
                    </div>
                    <div class="user" onclick="displayInformation('../assets/images/user2.png','Ronald Richards','Rwanda','ishimer','2001')">
                        <img class="userProfile" role="img" aria-label="User" src="../assets/images/user2.png">
                        <div class="credentials">
                            <div class="nameAndStatus">
                                <p class="name">Ronald Richards</p>
                                <div class="avail"></div>
                            </div>
                            <p class="email">emailemail@gmail.com</p>
                        </div>
                    </div>
                    <div class="user" onclick="displayInformation('../assets/images/user3.png','Devon Lane','Mozambique','devonlane@gmail.com','12/4/2007')">
                        <img class="userProfile" role="img" aria-label="User" src="../assets/images/user3.png">
                        <div class="credentials">
                            <div class="nameAndStatus">
                                <p class="name">Devon Lane</p>
                                <div class="avail"></div>
                            </div>
                            <p class="email">emailemail@gmail.com</p>
                        </div>
                    </div>
                    <div class="user" onclick="displayInformation('../assets/images/user4.png','Esther Howard','South Africa','estherhoward@gmail.com','12/4/2005')">
                        <img class="userProfile" role="img" aria-label="User" src="../assets/images/user4.png">
                        <div class="credentials">
                            <div class="nameAndStatus">
                                <p class="name">Esther Howard</p>
                                <div class="avail"></div>
                            </div>
                            <p class="email">emailemail@gmail.com</p>
                        </div>
                    </div>
                    <div class="user" onclick="displayInformation('../assets/images/user5.png','Savannah Nguyen','Kenya','sanavaken@hotmail.com','1/5/2020')">
                        <img class="userProfile" role="img" aria-label="User" src="../assets/images/user5.png">
                        <div class="credentials">
                            <div class="nameAndStatus">
                                <p class="name">Savannah Nguyen</p>
                                <div class="avail"></div>
                            </div>
                            <p class="email">emailemail@gmail.com</p>
                        </div>
                    </div>
                    <div class="user" onclick="displayInformation('../assets/images/user6.png','Eleanor Pena','Rwanda','eleanor@hotmail.com','1/5/2020')">
                        <img class="userProfile" role="img" aria-label="User" src="../assets/images/user6.png">
                        <div class="credentials">
                            <div class="nameAndStatus">
                                <p class="name">Eleanor Pena</p>
                                <div class="avail"></div>
                            </div>
                            <p class="email">emailemail@gmail.com</p>
                        </div>
                    </div>
                    <div class="user" onclick="displayInformation('../assets/images/user7.png','Cameron Williamson','Congo','camreom@hotmail.com','1/5/2020')">
                        <img class="userProfile" role="img" aria-label="User" src="../assets/images/user7.png">
                        <div class="credentials">
                            <div class="nameAndStatus">
                                <p class="name">Cameron Williamson</p>
                                <div class="avail"></div>
                            </div>
                            <p class="email">emailemail@gmail.com</p>
                        </div>
                    </div>
                    <div class="user" onclick="displayInformation('../assets/images/user4.png','Albert Flores','Burundi','flores@hotmail.com','1/5/2020')">
                        <img class="userProfile" role="img" aria-label="User" src="../assets/images/user4.png">
                        <div class="credentials">
                            <div class="nameAndStatus">
                                <p class="name">Albert Flores</p>
                                <div class="avail"></div>
                            </div>
                            <p class="email">emailemail@gmail.com</p>
                        </div>
                    </div>
                </div>
              </div>
        </div>
        <div class="col2" id="Articles">
            <div class="hdcnt">
                <div id="mobileNavigationButton" class="mobileNavigationButton" style="float:left; margin-top: 1.15rem; cursor: pointer;" onclick="REVEALDOM()">
                    <div class="line" style=" margin-top: .25rem; width: 2rem; height: .25rem; background: #000"></div>
                    <div class="line" style=" margin-top: .25rem; width: 2rem; height: .25rem; background: #000"></div>
                    <div class="line" style=" margin-top: .25rem; width: 2rem; height: .25rem; background: #000"></div>
                </div>
               <h1 class="col2Title" style="margin-left: 5rem;">Articles</h1>
            
               </div>
               <div class="buttonGroup">
                <div class="button" onclick="showPopup()">
                    <img src="../assets/images/new.png" alt="">
                    <h4 class="desc">New</h4>
                </div>
            
            </div>
            <div class="actionPopup" id="actionPopup">
                <h2>Choose action</h2>
                <h3 class="popupaction">Update</h3>
                <h3 class="popupaction">Delete</h3>
                <h3 class="popupaction" onclick="document.getElementById(`actionPopup`).style.display=`none`">Cancel</h3>
                
            </div>
            <div class="newsarea" id="newsarea">
               
                        
            </div>
            <!--For the addition of a new blog or article-->
   <div class="loader" id="loader">
       <div class="loadercont">
        <p>Processing</p>
       </div>
   </div>         
   <div class="pco" id="pco">
    <div class="popup" id="popup">
                
        <div class="first">
           <h2 class="fititle"><span>N</span>ew article</h2>
       </div>
       <input type="text" placeholder="Title" id="rectitle">
       <input type="text" placeholder="Image" id="recimage">
       <textarea name="" id="reccontent" cols="30" rows="8" placeholder="Enter Content | Drag and Drop images"></textarea>
       <div class="optionsSide">
           <div class="cancel" onclick="hidePopup()">
               <h4 class="word" >Cancel</h4>
           </div>
           <div class="cancel" onclick="newArticle()">
               <h4 class="word">Finish</h4>
           </div>
           
       </div>
       
                   </div>
           
   </div>
     <!--For the re,oval of an  article-->
   <div class="pcox" id="pcox">
    <div class="popup" id="listRemove">
                      
        <div class="first">
            <h2 class="fititle"><span>R</span>emove article</h2>
        </div>
        <div class="cont">
            <label class="cn">I won the hackathon
                <input type="checkbox" checked="checked">
                <span class="checkmark"></span>
              </label>
              <label class="cn">I created a new App
                <input type="checkbox">
                <span class="checkmark"></span>
              </label>
              <label class="cn">Amet minim mollit non 
                <input type="checkbox">
                <span class="checkmark"></span>
              </label>
              <label class="cn">Lorem ipsum dolor sit amet
                <input type="checkbox">
                <span class="checkmark"></span>
              </label>
              <label class="cn">nibh, elementum in tellus non
                <input type="checkbox">
                <span class="checkmark"></span>
              </label>
              <label class="cn">consectetur diam sollicitudin nec. 
                <input type="checkbox">
                <span class="checkmark"></span>
              </label>
              <label class="cn">I created a new App
                <input type="checkbox">
                <span class="checkmark"></span>
              </label>
              <label class="cn">I created a new App
                <input type="checkbox">
                <span class="checkmark"></span>
              </label>
        </div>
            <div class="optionsSide">
                <div class="cancel">
                    <h4 class="word" >Cancel</h4>
                </div>
                <div class="finish" onclick="hidePopupRemove()">
                    <h4 class="word">Finish</h4>
                </div>
                
            </div>
        </div>   
   </div>
        </div>
        
    </div>
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-analytics.js"></script>
    <script type = "text/javascript" >

    function snav() {
        console.log(`I am done`);
    }

google.charts.load('current', {
    'packages': ['corechart']
});

google.charts.setOnLoadCallback(drawSubscribers);
google.charts.setOnLoadCallback(drawUsers);

function drawSubscribers() {
    var data = google.visualization.arrayToDataTable([
        ['Day', 'Subscribers'],
        ['Mon', 1000],
        ['Tue', 1170],
        ['Wed', 660],
        ['Thur', 1030],
        [`Sat`, 234],
        [`Sub`, 5656]
    ]);

    var options = {
        title: 'Subscribers: This week',
        curveType: 'function',
        legend: {
            position: 'bottom'
        },
        backgroundColor: `#FAFAFA`,
        colors: ['D70046', '#000']
    };

    var chart = new google.visualization.LineChart(document.getElementById('subscribersChart'));

    chart.draw(data, options);
}

function drawUsers() {
    var data = google.visualization.arrayToDataTable([
        ['Day', 'Users'],
        ['Mon', 0],
        ['Tue', 2170],
        ['Wed', 18656],
        ['Thur', 2030],
        [`Sat`, 234],
        [`Sub`, 10656]
    ]);


    var options = {
        title: 'Users: This week',
        curveType: 'function',
        legend: {
            position: 'bottom'
        },
        backgroundColor: `#FAFAFA`,
        colors: ['D70046', '#000']
    };


    var chart = new google.visualization.ColumnChart(document.getElementById('trafficgraph'));

    chart.draw(data, options);
}

function revealDashboard() {
    document.getElementById(`col1`).style.display = block;
    console.log(`Revealed`);
}
var firebaseConfig = {
    apiKey: "AIzaSyCpi2f0eCI7LNdndXxsQPi6xEYPqdtzavE",
    authDomain: "portfoliocapstone-1fd25.firebaseapp.com",
    databaseURL: "https://portfoliocapstone-1fd25.firebaseio.com",
    projectId: "portfoliocapstone-1fd25",
    storageBucket: "portfoliocapstone-1fd25.appspot.com",
    messagingSenderId: "1080588359943",
    appId: "1:1080588359943:web:9aaea2900baf559b08cda2",
    measurementId: "G-RDPBQ88C5C"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);
firebase.analytics();
var db = firebase.firestore();
var blogs = [];


function populateBlogArea() {

    var db = firebase.firestore();
    var parent = document.getElementById("fd");
    var data = db.collection("news");
    document.getElementById("loader").style.display = "block";
    db.collection("news").get().then((querySnapShot) => {
        //console.log(querySnapShot);
        querySnapShot.forEach((blog) => {

            blogs.push(blog.data());

        });
        console.log(blogs.length);
        TRANSLATE_CLUSTERS(blogs).then(()=>{
            document.getElementById("loader").style.display = "none";
        }).catch(error=>{
           
        });
    });

    //console.log(blogs.length());

}



async function TRANSLATE_CLUSTERS(NEWS_ARRAY){
    console.log(`Status of the Function`);
    console.log(NEWS_ARRAY[0]);
    console.log(NEWS_ARRAY);
    var NEWS_AREA = document.getElementById("newsarea");

    var BLOCKS = (NEWS_ARRAY.length - (NEWS_ARRAY.length%3))/3;

    var i = 0;
    var j = 0;

    console.log(NEWS_ARRAY.length);        
    for(i = 0; i< (BLOCKS*3); i+=3){
        NEWS_AREA.innerHTML += `
        <div class="newsplot" id="one">
                <div class="plotcard" id="article${i}" onclick="revealAction(this)">
                    <img src="${NEWS_ARRAY[i].image}" alt="I won the prize">
                    <div class="dd">
                      
                        <h3 class="header">${NEWS_ARRAY[i].title}</h3>
                        <p class="content">${String(NEWS_ARRAY[i].content).slice(0,100)} ...</p>
                        </div>
                </div>
                <div class="plotcard" id="article${i+1}" onclick="revealAction(this)">
                    <img src="${NEWS_ARRAY[i+1].image}" alt="I won the prize">
                    <div class="dd">
                      
                        <h3 class="header">${NEWS_ARRAY[i+1].title}</h3>
                        <p class="content">${String(NEWS_ARRAY[i+1].content).slice(0,100)} ...</p>
                        </div>
                </div>
                <div class="plotcard" id="article${i+2}" onclick="revealAction(this)">
                    <img src="${NEWS_ARRAY[i+2].image}" alt="I won the prize">
                    <div class="dd">
                      
                        <h3 class="header">${NEWS_ARRAY[i+2].title}</h3>
                        <p class="content">${String(NEWS_ARRAY[i+2].content).slice(0,100)} ...</p>
                        </div>
                </div>
                
            </div>
        
        `;
    }
   
    var newItems = "";
    console.log(`Remaining Items are ${NEWS_ARRAY.length - BLOCKS*3}`);
    for(j = 0;j<(NEWS_ARRAY.length - BLOCKS*3); j++){
        console.log(NEWS_ARRAY[(BLOCKS*3)+j].title);
        if(NEWS_ARRAY[(BLOCKS*3)+j].title !== undefined){
            var realIndex = (BLOCKS*3)+j;
            newItems += `
        <div class="plotcard" id="article${realIndex}" onclick="revealAction(this)">
                    <img src="${NEWS_ARRAY[(BLOCKS*3)+j].image}" alt="I won the prize">
                    <div class="dd">
                      
                        <h3 class="header">${NEWS_ARRAY[(BLOCKS*3)+j].title}</h3>
                        <p class="content">${String(NEWS_ARRAY[(BLOCKS*3)+j].content).slice(0,100)} ...</p>
                        </div>
                </div>`;
        }
       

        
    }
    NEWS_AREA.innerHTML += `<div class="newsplot" id="one">
            ${newItems.replace(`undefined`,``)}
           </div> 
        `;
}
function REVEALDOM() {
    var myDoc = document.getElementById(`col1`);
    if (myDoc.style.display == `none`) {
        myDoc.style.display = `block`;

    } else {
        myDoc.style.display = `none`;
    }
    console.log(`I was called`);
}

function changeTab(contentID) {
    var litItems = document.getElementsByClassName(`col2`);
    var counter;
    for (counter = 0; counter < litItems.length; counter++) {
        litItems[counter].style.display = "none";
        console.log(Number(litItems.length));
    }
    console.log(Number(counter));
    document.getElementById(contentID).style.display = "block";
    console.log(`Trying to reveal ${contentID}`);

    switch (contentID) {
        case `col2`:
            document.querySelector(`#dashboard`).style.color = "#fff";
            document.querySelector(`#dashboard`).style.paddingRight = "20px";
            document.querySelector(`#dashboard`).style.borderRight = "#D70046 4px solid";
            document.querySelector(`#users`).style.borderRight = "none";
            document.querySelector(`#articles`).style.borderRight = "none";
            document.querySelector(`#users`).style.color = "#999";
            document.querySelector(`#articles`).style.color = "#999";
            break;
        case `usersTab`:
            document.querySelector(`#users`).style.color = "#fff";
            document.querySelector(`#dashboard`).style.borderRight = "none";
            document.querySelector(`#articles`).style.borderRight = "none";
            document.querySelector(`#users`).style.paddingRight = "20px";
            document.querySelector(`#users`).style.borderRight = "#D70046 4px solid";
            document.querySelector(`#articles`).style.color = "#999";
            document.querySelector(`#dashboard`).style.color = "#999";

            break;
        case `Articles`:
            document.querySelector(`#articles`).style.color = "#fff";
            document.querySelector(`#users`).style.borderRight = "none";
            document.querySelector(`#dashboard`).style.borderRight = "none";
            document.querySelector(`#articles`).style.paddingRight = "20px";
            document.querySelector(`#articles`).style.borderRight = "#D70046 4px solid";
            document.querySelector(`#dashboard`).style.color = "#999";
            document.querySelector(`#users`).style.color = "#999";


            break;

    }
    document.getElementById("mobileNavigationButton").style.display = "none";


}

function displayInformation(IMAGESOURCE, NAME, LOCATION, EMAIL, DATEJOOINED) {
    var imageSetter = document.getElementById(`profile`);
    var email = document.getElementById('email');
    var dateJoined = document.getElementById(`dateJoined`);
    var name = document.getElementById(`name`);
    var location = document.getElementById(`location`);
    var element = document.querySelector("#content");


    imageSetter.src = IMAGESOURCE;
    email.innerText = EMAIL;
    dateJoined.innerText = DATEJOOINED;
    name.innerText = NAME;
    location.innerText = LOCATION;
    element.scrollIntoView({behavior: "smooth", block: "start", inline: "nearest"});

}

function hidePopup() {
    var element = document.getElementById('pco');
    element.style.display = "none";
    console.log(element.innerHTML);
    console.log(`Called for the new`);
}

function showPopup() {
    var element = document.getElementById('pco');
    element.style.display = "block";
    console.log(element.innerHTML);
    console.log(`Called for the new`);
}

function showPopupRemove() {
    var element = document.getElementById('pcox');
    element.style.display = "block";
    console.log(`Trigerred the remove feature`);
}

function hidePopupRemove() {
    var element = document.getElementById('pcox');
    element.style.display = "none";
    console.log(`Trigerred the remove feature`);
}

function revealAction(CLICKED_ARTICLE) {
    var POPUP = document.getElementById("actionPopup");
    var popupactions = document.getElementsByClassName("popupaction");

    popupactions[1].addEventListener("click", function() {//delete
        DELETE(CLICKED_ARTICLE);
        POPUP.style.display = "none";
    });

    POPUP.style.display = "flex";
    console.log(CLICKED_ARTICLE.childNodes);
    popupactions[0].addEventListener("click", () => {
        upDateArticle(CLICKED_ARTICLE.childNodes, CLICKED_ARTICLE);
        POPUP.style.display = "none";
    })


}
async function DELETE(given){
    var INDEX = String(given.id).replace("article", "");
    const snap = await firebase.firestore().collection('news').get();
     snap.docs.map((doc) => {
        ik.push(String(doc.id));
        console.log(ik.length);
        console.log(INDEX);
        if(ik.length-1 == INDEX){
            eigenId = String(doc.id);
            console.log(eigenId);
            document.getElementById("loader").style.display = "block";
            firebase.firestore().collection('news').doc(eigenId).delete().then((stat)=>{
                alert(`Record deleted succesfully`);
                document.getElementById("loader").style.display = "none";
                document.getElementById("newsarea").innerHTML = "";
                window.location = "adminpanel.html";
             
            })
            var element = document.getElementById('pco');
    element.style.display = "none";
    console.log(element.innerHTML);
    console.log(`Called for the new`);
    
//break;
        }
     }
     );
}
var ik = [];
var eigenId;
async function getData(INDEX){
    console.log("Calling the getdata function");
   
    const snap = await firebase.firestore().collection('news').get();
     snap.docs.map((doc) => {
        ik.push(String(doc.id));
        console.log(ik.length);
        console.log(INDEX);
        if(ik.length-1 == INDEX){
            eigenId = String(doc.id);
            console.log(eigenId);
            document.getElementById("loader").style.display = "block";
            firebase.firestore().collection('news').doc(eigenId).set({
                content: document.getElementById("newcontent").value,
                image: document.getElementById("newimage").value,
                title: document.getElementById("newtitle").value
            }).then((error)=>{
                window.location="adminpanel.html";
                document.getElementById("loader").style.display = "none";
            });
            var element = document.getElementById('pco');
    element.style.display = "none";
    console.log(element.innerHTML);
    console.log(`Called for the new`);
//break;
        }
     }
     );
   
}
function newArticle(){
    var title = document.getElementById("rectitle");
    var content= document.getElementById("reccontent");
    var image = document.getElementById("recimage");

    document.getElementById("loader").style.display = "block";
    document.getElementById('pco').style.display = "none";
    db.collection("news").doc(String(title.value).replace(" ","")).set({
        content: content.value,
        title: title.value,
        image: image.value
    }).then(()=>{
        
        document.getElementById("loader").style.display = "none";
        window.location = "adminpanel.html";
        
    });
    

}
function displayQueries(){
    var parent = document.getElementById("qrows");
    db.collection("queries").get().then((querySnapshot)=>{
        querySnapshot.forEach((query)=>{
            parent.innerHTML += `
            <div class="row">
                    <h1 id="starging">${String(query.data().name).slice(0,1)}</h1>
                    <div class="messagebox">
                        <p class="message" id="querymessage">${String(query.data().message)}</p>
                        <small class="small" id="queryname">${String(query.data().name)}</small><br>
                        <small class="small" id="queryemail">${String(query.data().email)}</small><br>
                        <small class="small" id="queryphone">${String(query.data().phone)}</small><br>
                        <h3>Reply</h3>
                        <textarea name="" id="" cols="50" rows="20"  ></textarea>
                        <p class="send">Send</p>
                    </div>
                </div>
            `;
            console.log(query.data());
            console.log(`AFTER LOOPING`);
    });
        });
        //console.log(`AFTER LOOPING`+parent);

}

function upDateArticle(NODES, CARD) {
    console.clear();
    //console.log(blogs);
    var allId = [];
    
    var cardIndex = String(CARD.id).replace("article", "");
    
    console.log(`FROM THE EIGN`);
    console.log(eigenId);
    
    var element = document.getElementById('pco');
    //console.log(NODES[2]);
    //console.log(NODES[4]);
    element.innerHTML = `<div class="popup" id="popup">
                
                <div class="first">
                   <h2 class="fititle"><span>U</span>pdate article</h2>
               </div>
               <input type="text" placeholder="Title" id="newtitle" value="${blogs[cardIndex].title}">
               <input type="text" placeholder="New Image Source" id="newimage" value="${blogs[cardIndex].image}">

               <textarea name="" id="newcontent" cols="30" rows="8" placeholder="Enter Content | Drag and Drop images">${blogs[cardIndex].content}</textarea>
               <div class="optionsSide">
                   <div class="cancel" onclick="hidePopup()">
                       <h4 class="word" >Cancel</h4>
                   </div>
                   <div class="cancel" onclick="getData(${cardIndex})">
                       <h4 class="word">Finish</h4>
                   </div>    
               </div>
                           </div>`;
    element.style.display = "block";
}
populateBlogArea();
displayQueries();
</script>
</body>
</html>